{
  "version": 3,
  "sources": ["../src/shared.ts", "../src/types.ts"],
  "sourcesContent": [
    "import type { StoreOptions } from \"./types\";\n\n/**\n * Type helper for defining store configuration with type inference.\n */\nexport function defineStore<T>(config: StoreOptions<T>): StoreOptions<T> {\n    return config;\n}\n\n/**\n * deeply clones a value using structuredClone (modern) or JSON fallback.\n */\nexport function clone<T>(data: T): T {\n    try {\n        return structuredClone(data);\n    } catch (e) {\n        return JSON.parse(JSON.stringify(data));\n    }\n}\n\n/**\n * Deep merges a partial source object into a target object.\n * Handles recursion, Arrays, Dates, and RegExps.\n * Returns a new object reference (immutable).\n */\nexport function deepMerge<T>(target: T, source: unknown): T {\n    if (!isObject(source) || !isObject(target)) {\n        return isObject(source) ? clone(source as any) : (source as T);\n    }\n\n    if (source instanceof Date) {\n        return new Date(source.getTime()) as any;\n    }\n    if (source instanceof RegExp) {\n        return new RegExp(source) as any;\n    }\n\n    if (Array.isArray(source)) {\n        return clone(source) as any;\n    }\n\n    // If target is array/date/regexp but source is object, we overwrite, not merge.\n    if (Array.isArray(target) || target instanceof Date || target instanceof RegExp) {\n        return clone(source as any);\n    }\n\n    const result = { ...target } as any;\n\n    for (const key of Object.keys(source)) {\n        // Prevent prototype pollution\n        if (key === \"__proto__\" || key === \"constructor\" || key === \"prototype\") {\n            continue;\n        }\n\n        const targetValue = result[key];\n        const sourceValue = (source as any)[key];\n\n        if (isPlainObject(targetValue) && isPlainObject(sourceValue)) {\n            result[key] = deepMerge(targetValue, sourceValue);\n        } else {\n            result[key] = isObject(sourceValue) ? clone(sourceValue) : sourceValue;\n        }\n    }\n\n    return result;\n}\n\n\nfunction isObject(item: unknown): item is object {\n    return item !== null && typeof item === \"object\";\n}\n\nfunction isPlainObject(item: unknown): boolean {\n    return (\n        isObject(item) &&\n        !Array.isArray(item) &&\n        !(item instanceof Date) &&\n        !(item instanceof RegExp)\n    );\n}",
    "export interface StoreOptions<T> {\n    /** Unique name for the store (used for IPC channels). */\n    name: string;\n    /** The initial default state. */\n    defaults: T;\n    /**\n     * If true, the renderer updates the UI immediately before syncing with Main.\n     * If the sync fails, the state automatically rolls back.\n     * @default false\n     */\n    optimistic?: boolean;\n    /** Optional validator. Returns sanitized state or throws error to cancel update. */\n    validate?: (data: unknown) => T;\n}\n\nexport interface Middleware<T> {\n    /** Run on initialization. Return object to merge into initial state. */\n    onHydrate?: () => T | Promise<T | null | undefined>;\n    /** Run after every state change. Use for saving to disk/DB. */\n    onPersist?: (state: T) => void | Promise<void>;\n}\n\nexport type Listener<T> = (state: T) => void;\nexport type Unsubscribe = () => void;\n\n/** Recursive partial type helper */\nexport type DeepPartial<T> = T extends object ? {\n    [P in keyof T]?: DeepPartial<T[P]>;\n} : T;\n\n/**\n * Internal IPC Channel definitions.\n * @internal\n */\nexport const Channels = {\n    GET: (name: string) => `store:${name}:get`,\n    SET: (name: string) => `store:${name}:set`,\n    RESET: (name: string) => `store:${name}:reset`,\n    ON_CHANGE: (name: string) => `store:${name}:changed`,\n};"
  ],
  "mappings": "AAKO,SAAS,CAAc,CAAC,EAA0C,CACrE,OAAO,EAMJ,SAAS,CAAQ,CAAC,EAAY,CACjC,GAAI,CACA,OAAO,gBAAgB,CAAI,EAC7B,MAAO,EAAG,CACR,OAAO,KAAK,MAAM,KAAK,UAAU,CAAI,CAAC,GASvC,SAAS,CAAY,CAAC,EAAW,EAAoB,CACxD,GAAI,CAAC,EAAS,CAAM,GAAK,CAAC,EAAS,CAAM,EACrC,OAAO,EAAS,CAAM,EAAI,EAAM,CAAa,EAAK,EAGtD,GAAI,aAAkB,KAClB,OAAO,IAAI,KAAK,EAAO,QAAQ,CAAC,EAEpC,GAAI,aAAkB,OAClB,OAAO,IAAI,OAAO,CAAM,EAG5B,GAAI,MAAM,QAAQ,CAAM,EACpB,OAAO,EAAM,CAAM,EAIvB,GAAI,MAAM,QAAQ,CAAM,GAAK,aAAkB,MAAQ,aAAkB,OACrE,OAAO,EAAM,CAAa,EAG9B,IAAM,EAAS,IAAK,CAAO,EAE3B,QAAW,KAAO,OAAO,KAAK,CAAM,EAAG,CAEnC,GAAI,IAAQ,aAAe,IAAQ,eAAiB,IAAQ,YACxD,SAGJ,IAAM,EAAc,EAAO,GACrB,EAAe,EAAe,GAEpC,GAAI,EAAc,CAAW,GAAK,EAAc,CAAW,EACvD,EAAO,GAAO,EAAU,EAAa,CAAW,EAEhD,OAAO,GAAO,EAAS,CAAW,EAAI,EAAM,CAAW,EAAI,EAInE,OAAO,EAIX,SAAS,CAAQ,CAAC,EAA+B,CAC7C,OAAO,IAAS,MAAQ,OAAO,IAAS,SAG5C,SAAS,CAAa,CAAC,EAAwB,CAC3C,OACI,EAAS,CAAI,GACb,CAAC,MAAM,QAAQ,CAAI,GACnB,EAAE,aAAgB,OAClB,EAAE,aAAgB,QC3CnB,IAAM,EAAW,CACpB,IAAK,CAAC,IAAiB,SAAS,QAChC,IAAK,CAAC,IAAiB,SAAS,QAChC,MAAO,CAAC,IAAiB,SAAS,UAClC,UAAW,CAAC,IAAiB,SAAS,WAC1C",
  "debugId": "574769684C94A28764756E2164756E21",
  "names": []
}